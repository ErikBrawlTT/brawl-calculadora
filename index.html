<!DOCTYPE html>  
<html lang="es">  
<head>  
<meta charset="UTF-8" />  
<meta name="viewport" content="width=device-width, initial-scale=1.0" />  
<title>Calculadora Brawl Stars</title>  
<link href="https://fonts.googleapis.com/css2?family=Bangers&display=swap" rel="stylesheet">  
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>  
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>  
<style>  
body {  
  margin: 0;  
  font-family: 'Bangers', cursive;  
  background: url('Personajes-Brawl-Stars.webp') no-repeat center center fixed;  
  background-size: cover;  
  color: white;  
  text-align: center;  
  position: relative;  
}  
body::after {  
  content: "";  
  position: fixed;  
  inset: 0;  
  background: rgba(0,0,0,0.6);  
  backdrop-filter: blur(6px);  
  z-index: 0;  
}  
.container {  
  position: relative;  
  z-index: 1;  
  display: flex;  
  flex-direction: column;  
  align-items: center;  
  justify-content: center;  
  min-height: 100vh;  
  padding: 20px;  
}  
h1 {  
  font-size: 3rem;  
  margin-bottom: 20px;  
  display: flex;  
  align-items: center;  
  justify-content: center;  
  gap: 10px;  
  color: transparent;  
  background: linear-gradient(90deg, #00FFAA, #00CFFF, #FF00FF);  
  -webkit-background-clip: text;  
}  
h1 .diamond {  
  animation: glow 3s infinite alternate;  
}  
@keyframes glow {  
  0% { text-shadow: 0 0 5px rgba(255,255,255,0.5); }  
  50% { text-shadow: 0 0 15px rgba(255,255,255,1); }  
  100% { text-shadow: 0 0 5px rgba(255,255,255,0.5); }  
}  
form {  
  background: rgba(0,0,0,0.5);  
  border-radius: 60px;  
  padding: 20px;  
  max-width: 600px;  
  width:90%;  
  margin-bottom: 25px;  
}  
label{display:flex;justify-content:space-between;margin:8px 0;}  
input{width:100px;text-align:center;border:none;border-radius:8px;}  
.buttons{display:flex;justify-content:center;gap:25px;margin-top:15px;}  
button{padding:10px 20px;border:none;border-radius:12px;font-family:'Bangers';font-size:1.5rem;color:white;cursor:pointer;}  
#calcBtn {background:linear-gradient(90deg,#ff0080,#7928ca);}  
#clearBtn{background:linear-gradient(90deg,#00CFFF,#0077FF);}  
#shareBtn{background:linear-gradient(90deg,#00FFAA,#FF00FF);margin-top:20px;animation:pulse 1s infinite;}  
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}  
}  
#resultado{margin-top:10px;font-size:1.8rem;color:#00FFAA;}  
.visitas{margin-top:10px;font-size:1.4rem;color:#FFD700;}  
canvas{margin-top:15px;max-width:400px;position:relative;}  
/* üíé Brawler central */  
#centerDiamond {  
  position: absolute;  
  top: 43%;  
  left: 50%;  
  transform: translate(-50%, -50%);  
  display: none; 
} 
#centerDiamond img {
  width: 210px;
  height: 210px;
  border-radius: 50%;
  object-fit: contain;
  background: rgba(0,0,0,0.3);
  transform: translate(-0,5%, -0,5%); /* (mantengo tu l√≠nea original) */
}

/* === NUEVO: Display digital 7 segmentos para visitas globales === */
.seven-seg {
  display: inline-flex;
  gap: 6px;
  padding: 8px 12px;
  background: rgba(0,0,0,0.85);
  border: 2px solid #FFD700;
  border-radius: 12px;
  margin-top: 8px;
}
.digit {
  position: relative;
  width: 22px;
  height: 36px;
}
.seg {
  position: absolute;
  background: #003300;
  transition: background .25s, box-shadow .25s;
  border-radius: 2px;
}
.seg.on { background: #00FF66; box-shadow: 0 0 8px #00FF66; }
.seg.a { top: 0; left: 4px; width: 14px; height: 4px; }
.seg.b { top: 3px; right: 0; width: 4px; height: 14px; }
.seg.c { bottom: 3px; right: 0; width: 4px; height: 14px; }
.seg.d { bottom: 0; left: 4px; width: 14px; height: 4px; }
.seg.e { bottom: 3px; left: 0; width: 4px; height: 14px; }
.seg.f { top: 3px; left: 0; width: 4px; height: 14px; }
.seg.g { top: 50%; left: 4px; width: 14px; height: 4px; transform: translateY(-50%); }
</style>  
</head>  
<body>  
<div class="container">  
  <h1><span class="diamond">üíé</span> Calculadora Brawl Stars <span class="diamond">üíé</span></h1>  
  <form id="calcForm">  
    <label>üéüÔ∏è Brawl Pass: <input type="number" id="bpass" value="0"></label>  
    <label>ü©µ Comunes: <input type="number" id="comunes" value="0"></label>  
    <label>üíö Raras: <input type="number" id="raras" value="0"></label>  
    <label>üíú √âpicas: <input type="number" id="epicas" value="0"></label>  
    <label>‚ù§Ô∏è M√≠ticas: <input type="number" id="miticas" value="0"></label>  
    <label>üåü Legendarias: <input type="number" id="legendarias" value="0"></label>  
    <label>‚ö° Hipercarga: <input type="number" id="hipercarga" value="0"></label>  
    <label>üî• Maxeados: <input type="number" id="maxeados" value="0"></label>  
  </form>  
  <div class="buttons">  
    <button id="calcBtn">Calcular</button>  
    <button id="clearBtn">Limpiar</button>  
  </div>  
  <button id="shareBtn">üì§ Compartir</button>  

  <div id="resultado">Valor total: 0 ‚Ç¨</div>  

  <!-- Mantengo tu contador original (local) -->
  <div class="visitas">üëÄ Visitas (local): <span id="visitas">0</span></div>

  <!-- NUEVO: contador global con display 7 segmentos -->
  <div class="visitas">üåç Visitas globales:</div>
  <div id="visitasSevenSeg" class="seven-seg" aria-label="Visitas globales"></div>

  <div style="position:relative; display:inline-block;">  
    <canvas id="myChart" width="400" height="400"></canvas>  
    <!-- Imagen central -->  
    <div id="centerDiamond">  
      <img id="brawlerImg" src="https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/elprimo.png" alt="Brawler">  
    </div>  
  </div>  
</div>  

<script>  
// =================== TU CONTADOR ORIGINAL (localStorage) ===================
let visitas = localStorage.getItem("visitas") || 0;  
visitas++;   
localStorage.setItem("visitas", visitas);  
document.getElementById("visitas").innerText = visitas;  

// =================== NUEVO: contador GLOBAL con 7 segmentos ===================
const GLOBAL_NAMESPACE = "calculadora-brawlstars";  // c√°mbialo si quieres
const GLOBAL_KEY = "visitas";

const DIGIT_MAP = {
  0: ["a","b","c","d","e","f"],
  1: ["b","c"],
  2: ["a","b","g","e","d"],
  3: ["a","b","g","c","d"],
  4: ["f","g","b","c"],
  5: ["a","f","g","c","d"],
  6: ["a","f","g","e","c","d"],
  7: ["a","b","c"],
  8: ["a","b","c","d","e","f","g"],
  9: ["a","b","c","d","f","g"]
};

function crearDigito(num){
  const d = document.createElement("div");
  d.className = "digit";
  ["a","b","c","d","e","f","g"].forEach(s=>{
    const seg = document.createElement("div");
    seg.className = "seg "+s+(DIGIT_MAP[num]?.includes(s)?" on":"");
    d.appendChild(seg);
  });
  return d;
}
function dibujarSevenSeg(valor){
  const box = document.getElementById("visitasSevenSeg");
  if(!box) return;
  box.innerHTML = "";
  String(valor).split("").forEach(ch=>{
    const n = parseInt(ch);
    if (Number.isNaN(n)) return; // ignora caracteres no num√©ricos
    box.appendChild(crearDigito(n));
  });
}
function animarSevenSeg(desde, hasta, dur=800){
  let start=null;
  function step(ts){
    if(!start) start=ts;
    const p = Math.min((ts-start)/dur,1);
    const val = Math.floor(desde + (hasta-desde)*p);
    dibujarSevenSeg(val);
    if(p<1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

// Preferencia: CounterAPI (principal). Fallback: CountAPI.
async function incrementarGlobal(){
  // 1) CounterAPI
  try{
    const res = await fetch(`https://counterapi.dev/api/increment?namespace=${encodeURIComponent(GLOBAL_NAMESPACE)}&key=${encodeURIComponent(GLOBAL_KEY)}`);
    if(res.ok){
      const data = await res.json();
      const actual = parseInt(document.getElementById("visitasSevenSeg")?.dataset?.val || "0");
      animarSevenSeg(isNaN(actual)?0:actual, data.value);
      document.getElementById("visitasSevenSeg").dataset.val = data.value;
      return;
    }
    throw new Error("CounterAPI no OK");
  }catch(e){
    console.warn("CounterAPI fall√≥, probando CountAPI...", e);
  }
  // 2) CountAPI (fallback)
  try{
    // crea si no existe
    await fetch(`https://api.countapi.xyz/create?namespace=${encodeURIComponent(GLOBAL_NAMESPACE)}&key=${encodeURIComponent(GLOBAL_KEY)}&value=0`);
    const res2 = await fetch(`https://api.countapi.xyz/update/${encodeURIComponent(GLOBAL_NAMESPACE)}/${encodeURIComponent(GLOBAL_KEY)}/?amount=1`);
    const data2 = await res2.json();
    const actual = parseInt(document.getElementById("visitasSevenSeg")?.dataset?.val || "0");
    animarSevenSeg(isNaN(actual)?0:actual, data2.value);
    document.getElementById("visitasSevenSeg").dataset.val = data2.value;
  }catch(e){
    console.error("CountAPI tambi√©n fall√≥:", e);
  }
}
async function leerGlobal(){
  // 1) CounterAPI
  try{
    const res = await fetch(`https://counterapi.dev/api/value?namespace=${encodeURIComponent(GLOBAL_NAMESPACE)}&key=${encodeURIComponent(GLOBAL_KEY)}`);
    if(res.ok){
      const data = await res.json();
      const actual = parseInt(document.getElementById("visitasSevenSeg")?.dataset?.val || "0");
      animarSevenSeg(isNaN(actual)?0:actual, data.value, 600);
      document.getElementById("visitasSevenSeg").dataset.val = data.value;
      return;
    }
    throw new Error("CounterAPI no OK");
  }catch(e){
    console.warn("CounterAPI value fall√≥, probando CountAPI...", e);
  }
  // 2) CountAPI (fallback)
  try{
    const res2 = await fetch(`https://api.countapi.xyz/get/${encodeURIComponent(GLOBAL_NAMESPACE)}/${encodeURIComponent(GLOBAL_KEY)}`);
    const data2 = await res2.json();
    const actual = parseInt(document.getElementById("visitasSevenSeg")?.dataset?.val || "0");
    animarSevenSeg(isNaN(actual)?0:actual, data2.value, 600);
    document.getElementById("visitasSevenSeg").dataset.val = data2.value;
  }catch(e){
    console.error("CountAPI get fall√≥:", e);
  }
}

// Inicializa display y arranca
dibujarSevenSeg(0);
incrementarGlobal();
setInterval(leerGlobal, 10000);

// =================== RESTO DE TU C√ìDIGO ORIGINAL ===================
// Confeti  
function lanzarConfeti() {  
  const duration = 4000;  
  const end = Date.now() + duration;  
  (function frame() {  
    confetti({  
      particleCount: 10,  
      startVelocity: 3,  
      gravity: 0.25,  
      spread: 360,  
      ticks: 200,  
      origin: { x: Math.random(), y: Math.random() * 0.4 },  
      colors: ['#ff0000','#00ff00','#0000ff','#ffff00','#ff00ff','#00ffff']  
    });  
    if (Date.now() < end) requestAnimationFrame(frame);  
  })();  
}  
  
// Sonido y vibraci√≥n  
function beep(freq){const ctx=new (AudioContext||webkitAudioContext)(),o=ctx.createOscillator(),g=ctx.createGain();o.type="square";o.frequency.value=freq;o.connect(g);g.connect(ctx.destination);g.gain.setValueAtTime(.15,ctx.currentTime);o.start();o.stop(ctx.currentTime+.15);}  
function vibrar(ms=80){if(navigator.vibrate)navigator.vibrate(ms);}  
  
// Animar n√∫mero  
function animateNumber(finalValue){  
  const resultado = document.getElementById("resultado");  
  const start=0,duration=2000,startTime=performance.now();  
  function step(now){  
    const p=Math.min((now-startTime)/duration,1);  
    resultado.innerText="Valor total: "+Math.floor(start+(finalValue-start)*p)+" ‚Ç¨";  
    if(p<1)requestAnimationFrame(step);  
  }  
  requestAnimationFrame(step);  
}  
  
// Gr√°fico  
let chart;  
function calcular(){  
  beep(600); vibrar(80);  
  const bpass = document.getElementById("bpass").value || 0;  
  const comunes = document.getElementById("comunes").value || 0;  
  const raras = document.getElementById("raras").value || 0;  
  const epicas = document.getElementById("epicas").value || 0;  
  const miticas = document.getElementById("miticas").value || 0;  
  const legendarias = document.getElementById("legendarias").value || 0;  
  const hipercarga = document.getElementById("hipercarga").value || 0;  
  const maxeados = document.getElementById("maxeados").value || 0;  
  
  const valores={  
    "üéüÔ∏è Brawl Pass":bpass*10,  
    "ü©µ Comunes":comunes*2,  
    "üíö Raras":raras*5,  
    "üíú √âpicas":epicas*10,  
    "‚ù§Ô∏è M√≠ticas":miticas*12,  
    "üåü Legendarias":legendarias*15,  
    "‚ö° Hipercarga":hipercarga*20,  
    "üî• Maxeados":maxeados*50  
  };  
  const total = Object.values(valores).reduce((a,b)=>a+b,0);  
  animateNumber(total);  
  
  // Mostrar SIEMPRE el Brawler  
  document.getElementById("centerDiamond").style.display = "block";  
  
  const data={  
    labels:Object.keys(valores),  
    datasets:[{  
      data:Object.values(valores),  
      backgroundColor:["#1E90FF","#00CED1","#32CD32","#BA55D3","#FF4500","#FFD700","#FF69B4","#FF0000"],  
      borderWidth:2  
    }]  
  };  
  
  const config={  
    type:'doughnut',  
    data:data,  
    options:{  
      cutout:"70%",   // agrandamos hueco para que no se corte la imagen  
      plugins:{legend:{display:true,position:'bottom'}}  
    }  
  };  
  
  if(chart){chart.destroy();}  
  const ctx = document.getElementById('myChart').getContext('2d');  
  chart = new Chart(ctx,config);  
  
  lanzarConfeti();  
}  
  
// ‚õî Desactivar rebote original  
function startDiamondBounce(){}  
  
// Limpiar  
function limpiar(){  
  document.getElementById("calcForm").reset();  
  document.getElementById("resultado").innerText="Valor total: 0 ‚Ç¨";  
  if(chart){chart.destroy();}  
  stopDiamondBounce();  
  document.getElementById("centerDiamond").style.display="none";  
}  
  
// Bot√≥n compartir  
document.getElementById("shareBtn").addEventListener("click", async () => {  
  const url = window.location.href;  
  const text = "Mira cu√°nto valen mis Brawlers en Brawl Stars!";  
  if (navigator.share) {  
    try {  
      await navigator.share({ title: "Calculadora Brawl Stars", text: text, url: url });  
    } catch (err) { console.log("Cancelado", err); }  
  } else {  
    alert("Tu navegador no soporta compartir nativo.");  
  }  
});  
  
document.getElementById("calcBtn").addEventListener("click",calcular);  
document.getElementById("clearBtn").addEventListener("click",limpiar);  
  
// üîÑ Cambiar Brawler central cada 3 segundos (10 im√°genes)  
const brawlers = [  
  "https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/elprimo.png",  
  "https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/colt.png",  
  "https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/nita.png",  
  "https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/edgar.png",  
  "https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/spike.png",  
  "https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/penny.png",  
  "https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/darryl.png",  
  "https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/rico.png",  
  "https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/mortis.png",  
  "https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/bea.png"  
];  
  
let current = 0;  
const brawlerImg = document.getElementById("brawlerImg");  
document.getElementById("centerDiamond").style.display = "block";  
  
setInterval(() => {  
  current = (current + 1) % brawlers.length;  
  brawlerImg.src = brawlers[current];  
}, 3000);  
</script>  
</body>  
</html>
