<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Calculadora Brawl Stars</title>
<link href="https://fonts.googleapis.com/css2?family=Bangers&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<style>
body {
  margin: 0;
  font-family: 'Bangers', cursive;
  background: url('Personajes-Brawl-Stars.webp') no-repeat center center fixed;
  background-size: cover;
  color: white;
  text-align: center;
  position: relative;
}
body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(6px);
  z-index: 0;
}
.container {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 20px;
}
h1 {
  font-size: 3rem;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  color: transparent;
  background: linear-gradient(90deg, #00FFAA, #00CFFF, #FF00FF);
  -webkit-background-clip: text;
}
h1 .diamond {
  animation: glow 2s infinite alternate;
}
@keyframes glow {
  0% { text-shadow: 0 0 5px rgba(255,255,255,0.5); }
  50% { text-shadow: 0 0 15px rgba(255,255,255,1); }
  100% { text-shadow: 0 0 5px rgba(255,255,255,0.5); }
}
form {
  background: rgba(0,0,0,0.5);
  border-radius: 20px;
  padding: 20px;
  max-width: 600px;
  width:90%;
  margin-bottom: 25px;
}
label{display:flex;justify-content:space-between;margin:8px 0;}
input{width:100px;text-align:center;border:none;border-radius:8px;}
.buttons{display:flex;justify-content:center;gap:25px;margin-top:15px;}
button{padding:10px 20px;border:none;border-radius:12px;font-family:'Bangers';font-size:1.5rem;color:white;cursor:pointer;}
#calcBtn {background:linear-gradient(90deg,#ff0080,#7928ca);}
#clearBtn{background:linear-gradient(90deg,#00CFFF,#0077FF);}
#shareBtn{background:linear-gradient(90deg,#00FFAA,#FF00FF);margin-top:20px;animation:pulse 1s infinite;}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}
#resultado{margin-top:10px;font-size:1.8rem;color:#00FFAA;}
.visitas{margin-top:10px;font-size:1.4rem;color:#FFD700;}
canvas{margin-top:15px;max-width:400px;position:relative;}
/* üíé Brawler central */
#centerDiamond {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: none;
  border-radius: 50%;
  overflow: hidden;
}
#centerDiamond img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  border-radius: 50%;
  background: rgba(0,0,0,0.3);
}
</style>
</head>
<body>
<div class="container">
  <h1><span class="diamond">üíé</span> Calculadora Brawl Stars <span class="diamond">üíé</span></h1>

  <form id="calcForm">
    <label>üéüÔ∏è Brawl Pass: <input type="number" id="bpass" value="0"></label>
    <label>ü©µ Comunes: <input type="number" id="comunes" value="0"></label>
    <label>üíö Raras: <input type="number" id="raras" value="0"></label>
    <label>üíú √âpicas: <input type="number" id="epicas" value="0"></label>
    <label>‚ù§Ô∏è M√≠ticas: <input type="number" id="miticas" value="0"></label>
    <label>üåü Legendarias: <input type="number" id="legendarias" value="0"></label>
    <label>‚ö° Hipercarga: <input type="number" id="hipercarga" value="0"></label>
    <label>üî• Maxeados: <input type="number" id="maxeados" value="0"></label>
  </form>

  <div class="buttons">
    <button id="calcBtn">Calcular</button>
    <button id="clearBtn">Limpiar</button>
  </div>

  <button id="shareBtn">üì§ Compartir</button>

  <div id="resultado">Valor total: 0 ‚Ç¨</div>
  <div class="visitas">üëÄ Visitas: <span id="visitas">0</span></div>

  <div style="position:relative; display:inline-block;">
    <canvas id="myChart" width="400" height="400"></canvas>
    <!-- Imagen central -->
    <div id="centerDiamond">
      <img id="brawlerImg" src="https://raw.githubusercontent.com/ErikBrawlTT/brawl-calculadora/main/Brawlers/elprimo.png" alt="Brawler">
    </div>
  </div>
</div>

<script>
// Contador de visitas
let visitas = localStorage.getItem("visitas") || 0;
visitas++; 
localStorage.setItem("visitas", visitas);
document.getElementById("visitas").innerText = visitas;

// Confeti
function lanzarConfeti() {
  const duration = 4000;
  const end = Date.now() + duration;
  (function frame() {
    confetti({
      particleCount: 10,
      startVelocity: 3,
      gravity: 0.25,
      spread: 360,
      ticks: 200,
      origin: { x: Math.random(), y: Math.random() * 0.4 },
      colors: ['#ff0000','#00ff00','#0000ff','#ffff00','#ff00ff','#00ffff']
    });
    if (Date.now() < end) requestAnimationFrame(frame);
  })();
}

// Sonido y vibraci√≥n
function beep(freq){const ctx=new (AudioContext||webkitAudioContext)(),o=ctx.createOscillator(),g=ctx.createGain();o.type="square";o.frequency.value=freq;o.connect(g);g.connect(ctx.destination);g.gain.setValueAtTime(.15,ctx.currentTime);o.start();o.stop(ctx.currentTime+.15);}
function vibrar(ms=80){if(navigator.vibrate)navigator.vibrate(ms);}

// Animar n√∫mero
function animateNumber(finalValue){
  const resultado = document.getElementById("resultado");
  const start=0,duration=2000,startTime=performance.now();
  function step(now){
    const p=Math.min((now-startTime)/duration,1);
    resultado.innerText="Valor total: "+Math.floor(start+(finalValue-start)*p)+" ‚Ç¨";
    if(p<1)requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

// Gr√°fico
let chart;
function calcular(){
  beep(600); vibrar(80);
  const bpass = parseInt(document.getElementById("bpass").value) || 0;
  const comunes = parseInt(document.getElementById("comunes").value) || 0;
  const raras = parseInt(document.getElementById("raras").value) || 0;
  const epicas = parseInt(document.getElementById("epicas").value) || 0;
  const miticas = parseInt(document.getElementById("miticas").value) || 0;
  const legendarias = parseInt(document.getElementById("legendarias").value) || 0;
  const hipercarga = parseInt(document.getElementById("hipercarga").value) || 0;
  const maxeados = parseInt(document.getElementById("maxeados").value) || 0;

  const valores={
    "üéüÔ∏è Brawl Pass":bpass*10,
    "ü©µ Comunes":comunes*2,
    "üíö Raras":raras*5,
    "üíú √âpicas":epicas*10,
    "‚ù§Ô∏è M√≠ticas":miticas*25,
    "üåü Legendarias":legendarias*50,
    "‚ö° Hipercarga":hipercarga*5,
    "üî• Maxeados":maxeados*15
  };

  const labels = Object.keys(valores);
  const data = Object.values(valores);

  animateNumber(data.reduce((a,b)=>a+b,0));
  lanzarConfeti();

  if(chart) chart.destroy();

  const ctx = document.getElementById('myChart').getContext('2d');
  chart = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: labels,
      datasets: [{
        data: data,
        backgroundColor: ['#ff6384','#36a2eb','#cc65fe','#ffce56','#00ffcc','#ff00ff','#ffaa00','#00ffff'],
        borderWidth: 2
      }]
    },
    options: {
      responsive:true,
      maintainAspectRatio:true,
      cutout: '60%',
      plugins: {
        legend: { position: 'bottom' }
      },
      onResize: (chart)=>{ ajustarBrawler(chart); }
    }
  });

  // Mostrar imagen central y ajustar tama√±o
  const centerDiv = document.getElementById("centerDiamond");
  centerDiv.style.display = "block";
  ajustarBrawler(chart);
}

// Ajusta tama√±o del Brawler autom√°ticamente al agujero
function ajustarBrawler(chart){
  if(!chart) return;
  const centerDiv = document.getElementById("centerDiamond");
  const canvas = chart.canvas;
  const minDim = Math.min(canvas.width, canvas.height);
  const cutout = parseInt(chart.options.cutout) || 0;
  const size = minDim * (parseFloat(chart.options.cutout)/100);
  centerDiv.style.width = size + "px";
  centerDiv.style.height = size + "px";
}

document.getElementById("calcBtn").addEventListener("click",(e)=>{
  e.preventDefault();
  calcular();
});
document.getElementById("clearBtn").addEventListener("click",(e)=>{
  e.preventDefault();
  document.getElementById("calcForm").reset();
  document.getElementById("resultado").innerText="Valor total: 0 ‚Ç¨";
  if(chart) chart.destroy();
  document.getElementById("centerDiamond").style.display="none";
});
  <!-- Coloca esto al final de tu c√≥digo, justo antes del cierre de </body> -->
<script>
// Ajuste autom√°tico del brawler central al agujero del doughnut
function ajustarBrawlerCentral() {
  if(!chart) return; // Espera a que el chart exista
  const canvas = document.getElementById('myChart');
  const img = document.getElementById('brawlerImg'); // tu imagen del brawler central

  const chartArea = chart.chartArea;
  const radius = (chartArea.right - chartArea.left) / 2;
  const cutoutPercent = parseFloat(chart.options.cutout) / 100 || 0.6; // 60% por defecto

  // Tama√±o del brawler = di√°metro del agujero central
  const holeDiameter = radius * 2 * cutoutPercent;
  img.style.width = img.style.height = holeDiameter + 'px';

  // Posicionar centrado
  img.style.position = 'absolute';
  img.style.top = canvas.offsetTop + radius + 'px';
  img.style.left = canvas.offsetLeft + radius + 'px';
  img.style.transform = 'translate(-50%, -50%)';
  img.style.display = 'block';
}

// Llamar al calcular y al renderizar chart
setTimeout(ajustarBrawlerCentral, 100); // espera a que chart est√© dibujado
window.addEventListener('resize', ajustarBrawlerCentral);
</script>
</script>
</body>
</html>
