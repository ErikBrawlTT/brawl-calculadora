<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Calculadora Brawl Stars</title>
<link href="https://fonts.googleapis.com/css2?family=Bangers&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<style>
body {
  margin: 0;
  font-family: 'Bangers', cursive;
  background: url('Personajes-Brawl-Stars.webp') no-repeat center center fixed;
  background-size: cover;
  color: white;
  text-align: center;
  position: relative;
}
body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(6px);
  z-index: 0;
}
.container {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 20px;
}
h1 {
  font-size: 3rem;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  color: transparent;
  background: linear-gradient(90deg, #00FFAA, #00CFFF, #FF00FF);
  -webkit-background-clip: text;
}
@keyframes glow {
  0% { text-shadow: 0 0 5px rgba(255,255,255,0.5); }
  50% { text-shadow: 0 0 15px rgba(255,255,255,1); }
  100% { text-shadow: 0 0 5px rgba(255,255,255,0.5); }
}
#centerDiamond {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  display:none;
}
#centerDiamond img{
  width:60px;
  height:60px;
}
</style>
</head>
<body>
<div class="container">
  <h1>ğŸ’ Calculadora Brawl Stars ğŸ’</h1>

  <form id="calcForm">
    <label>ğŸŸï¸ Brawl Pass: <input type="number" id="bpass" value="0"></label>
    <label>ğŸ©µ Comunes: <input type="number" id="comunes" value="0"></label>
    <label>ğŸ’š Raras: <input type="number" id="raras" value="0"></label>
    <label>ğŸ’œ Ã‰picas: <input type="number" id="epicas" value="0"></label>
    <label>â¤ï¸ MÃ­ticas: <input type="number" id="miticas" value="0"></label>
    <label>ğŸŒŸ Legendarias: <input type="number" id="legendarias" value="0"></label>
    <label>âš¡ Hipercarga: <input type="number" id="hipercarga" value="0"></label>
    <label>ğŸ”¥ Maxeados: <input type="number" id="maxeados" value="0"></label>
  </form>

  <div class="buttons">
    <button id="calcBtn">Calcular</button>
    <button id="clearBtn">Limpiar</button>
  </div>

  <button id="shareBtn">ğŸ“¤ Compartir</button>

  <div id="resultado">Valor total: 0 â‚¬</div>
  <div class="visitas">ğŸ‘€ Visitas: <span id="visitas">0</span></div>

  <div style="position:relative; display:inline-block;">
    <canvas id="myChart" width="400" height="400"></canvas>
    <!-- ğŸ”½ imagen central -->
    <div id="centerDiamond"><img id="brawlerImage" src=""></div>
  </div>
</div>

<script>
// contador de visitas
let visitas = localStorage.getItem("visitas") || 0;
visitas++;
localStorage.setItem("visitas", visitas);
document.getElementById("visitas").innerText = visitas;

// confeti
function lanzarConfeti(){
  const duration = 4000;
  const end = Date.now() + duration;
  (function frame(){
    confetti({
      particleCount:10,
      startVelocity:3,
      gravity:0.25,
      spread:360,
      ticks:200,
      origin:{x:Math.random(),y:Math.random()*0.4},
      colors:['#ff0000','#00ff00','#0000ff','#ffff00','#ff00ff','#00ffff']
    });
    if(Date.now() < end) requestAnimationFrame(frame);
  })();
}

// animar nÃºmero
function animateNumber(finalValue){
  const resultado=document.getElementById("resultado");
  const start=0,duration=2000,startTime=performance.now();
  function step(now){
    const p=Math.min((now-startTime)/duration,1);
    resultado.innerText="Valor total: "+Math.floor(start+(finalValue-start)*p)+" â‚¬";
    if(p<1)requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

// âš¡ brawlers alternativos (imagenes)
const brawlersAlternativos = [
  'leon.webp',
  'spike.webp',
  'colt.webp',
  'bea.webp'
];
let currentBrawler = 0;
function startBrawlerSwap(){
  const img=document.getElementById("brawlerImage");
  setInterval(()=>{
    currentBrawler = (currentBrawler + 1) % brawlersAlternativos.length;
    img.src=brawlersAlternativos[currentBrawler];
  },2000);
}

let chart;
function calcular(){
  const diamond = document.getElementById("centerDiamond");
  diamond.style.display="block";

  // ğŸŸ¡ empezar rotaciÃ³n de brawlers
  document.getElementById("brawlerImage").src = brawlersAlternativos[0];
  startBrawlerSwap();

  const bpass = document.getElementById("bpass").value || 0;
  const comunes = document.getElementById("comunes").value || 0;
  const raras = document.getElementById("raras").value || 0;
  const epicas = document.getElementById("epicas").value || 0;
  const miticas = document.getElementById("miticas").value || 0;
  const legendarias = document.getElementById("legendarias").value || 0;
  const hipercarga = document.getElementById("hipercarga").value || 0;
  const maxeados = document.getElementById("maxeados").value || 0;

  const valores={
    "ğŸŸï¸ Brawl Pass":bpass*10,
    "ğŸ©µ Comunes":comunes*2,
    "ğŸ’š Raras":raras*5,
    "ğŸ’œ Ã‰picas":epicas*10,
    "â¤ï¸ MÃ­ticas":miticas*12,
    "ğŸŒŸ Legendarias":legendarias*15,
    "âš¡ Hipercarga":hipercarga*20,
    "ğŸ”¥ Maxeados":maxeados*50
  };
  const total = Object.values(valores).reduce((a,b)=>a+b,0);
  animateNumber(total);

  const data={
    labels:Object.keys(valores),
    datasets:[{
      data:Object.values(valores),
      backgroundColor:["#1E90FF","#00CED1","#32CD32","#BA55D3","#FF4500","#FFD700","#FF69B4","#FF0000"],
      borderWidth:2
    }]
  };

  const config={
    type:'doughnut',
    data:data,
    options:{cutout:"50%",plugins:{legend:{display:true,position:'bottom'}}}
  };

  if(chart){chart.destroy();}
  const ctx=document.getElementById('myChart').getContext('2d');
  chart=new Chart(ctx,config);

  lanzarConfeti();
}

function limpiar(){
  document.getElementById("calcForm").reset();
  document.getElementById("resultado").innerText="Valor total: 0 â‚¬";
  if(chart){chart.destroy();}
  document.getElementById("centerDiamond").style.display="none";
}

document.getElementById("shareBtn").addEventListener("click",async()=>{
  const url=window.location.href;
  const text="Mira cuÃ¡nto valen mis Brawlers en Brawl Stars!";
  if(navigator.share){
    try{await navigator.share({title:"Calculadora Brawl Stars",text:text,url:url});}
    catch(err){console.log("Cancelado",err);}
  }else{alert("Tu navegador no soporta compartir nativo.");}
});

document.getElementById("calcBtn").addEventListener("click",calcular);
document.getElementById("clearBtn").addEventListener("click",limpiar);
</script>
</body>
</html>
